-- set @today=curdate();
-- set @yesterday=date_sub(curdate(), INTERVAL 1 DAY);
-- set @tomorrow=date_sub(curdate(), INTERVAL -1 DAY);
-- set '2016-01-01'=@yesterday;
-- set '2016-08-22'=@today;

select 
kai_ting_ri_qi,
an_you,
an_hao,
fa_yuan fa_yuan_ming_cheng,
fa_ting shen_li_fa_ting,
shen_pan_zhang zhu_shen_fa_guan,
cheng_ban_bu_men cheng_ban_ting,
concat('原告：',yuan_gao,'；被告：',bei_gao) dang_shi_ren
from `hshfy`
where add_time >='2016-01-01' and add_time<'2016-08-22'
union all
-- 广东
select 
kai_ting_shi_jian kai_ting_ri_qi,
'' an_you,
an_hao,
fa_yuan fa_yuan_ming_cheng,
kai_ting_di_dian shen_li_fa_ting,
zhu_shen_fa_guan,
'' cheng_ban_ting,
dang_shi_ren
from `gdcourts`
where add_time >='2016-01-01' and add_time<'2016-08-22'
union all
-- 浙江
select 
kai_ting_ri_qi,
an_you,
an_hao,
fa_yuan fa_yuan_ming_cheng,
fa_ting shen_li_fa_ting,
shen_pan_zhang zhu_shen_fa_guan,
cheng_ban_bu_men cheng_ban_ting,
concat(yuan_gao,'；',bei_gao) dang_shi_ren
from `zjsfgkw`
where add_time >='2016-01-01' and add_time<'2016-08-22'
union all
-- 江苏-南京
select 
ri_qi kai_ting_ri_qi,
an_you,
an_hao,
'南京市中级人民法院' fa_yuan_ming_cheng,
fa_ting shen_li_fa_ting,
zhu_shen zhu_shen_fa_guan,
'' cheng_ban_ting,
dang_shi_ren
from `js_nanjing`
where updatetime>='2016-01-01' and updatetime<'2016-08-22'
union all
-- 江苏-扬州
select
shi_jian kai_ting_ri_qi,
an_you,
an_hao,
'扬州市中级人民法院' fa_yuan_ming_cheng,
fa_ting shen_li_fa_ting,
zhu_shen zhu_shen_fa_guan,
'' cheng_ban_ting,
concat('原告：',yuan_gao,'；被告',bei_gao) dang_shi_ren
from `js_yangzhou`
where updatetime>='2016-01-01' and updatetime<'2016-08-22'
union all
-- 江苏-苏州
select 
ri_qi kai_ting_ri_qi,
an_you,
an_hao,
'苏州市中级人民法院' fa_yuan_ming_cheng,
di_dian shen_li_fa_ting,
shen_pan_zhang zhu_shen_fa_guan,
'' cheng_ban_ting,
dang_shi_ren
from `szfy`
where add_time >='2016-01-01' and add_time<'2016-08-22'
-- 山东中级法院
union all
select 
kai_ting_ri_qi,
an_you,
'' an_hao,
fa_yuan fa_yuan_ming_cheng,
fa_ting shen_li_fa_ting,
shen_pan_zhang zhu_shen_fa_guan,
'' cheng_ban_ting,
concat('原告：',yuan_gao,'；被告：',bei_gao) dang_shi_ren
from `sdzjfy`
where add_time >='2016-01-01' and add_time<'2016-08-22'
-- 江苏-无锡（字段对应有误当事人字段待解析）[已添加]
-- 江苏-泰州（当事人字段待解析）[已添加]
-- 江苏常州（当事人、案由字段待解析）[已添加]
-- 江苏徐州（字段待解析）
-- 江苏南通（当事人、案由字段待解析）[已添加]
-- 江苏连云港（当事人、案由字段待解析）[已添加]
-- 山东高院（字段待解析）
-- 福建厦门(当事人字段待解析)[已添加]
-- 福建高院（当事人案由字段待解析）
-- 北京（字段待解析）

建立mysql连接...
mysql连接建立成功
++1000
++2000
++3000
++4000
++5000
++6000
++7000
++8000
++9000
++10000
++11000
++12000
++13000
++14000
++15000
++16000
++17000
++18000
++19000
++20000
++21000
++22000
++23000
++24000
++25000
++26000
++27000
++28000
++29000
++30000
++31000
++32000
++33000
++34000
++35000
++36000
++37000
++38000
++39000
++40000
++41000
++42000
++43000
++44000
++45000
++46000
++47000
++48000
++49000
++50000
++51000
++52000
++53000
++54000
++55000
++56000
++57000
++58000
++59000
++60000
++61000
++62000
++63000
++64000
++65000
++66000
++67000
++68000
++69000
++70000
++71000
++72000
++73000
++74000
++75000
++76000
++77000
++78000
++79000
++80000
++81000
++82000
++83000
++84000
++85000
++86000
++87000
++88000
++89000
++90000
++91000
++92000
++93000
++94000
++95000
++96000
++97000
++98000
++99000
++100000
++101000
++102000
++103000
++104000
++105000
++106000
++107000
++108000
++109000
++110000
++111000
++112000
++113000
++114000
++115000
++116000
++117000
++118000
++119000
++120000
++121000
++122000
++123000
++124000
++125000
++126000
++127000
++128000
++129000
++130000
++131000
++132000
++133000
++134000
++135000
++136000
++137000
++138000
++139000
++140000
++141000
++142000
++143000
++144000
++145000
++146000
++147000
++148000
++149000
++150000
++151000
++152000
++153000
++154000
++155000
++156000
++157000
++158000
++159000
++160000
++161000
++162000
++163000
++164000
++165000
++166000
++167000
++168000
++169000
++170000
++171000
++172000
++173000
++174000
++175000
++176000
++177000
++178000
++179000
++180000
++181000
++182000
++183000
++184000
++185000
++186000
++187000
++188000
++189000
++190000
++191000
++192000
++193000
++194000
++195000
++196000
++197000
++198000
++199000
++200000
++201000
++202000
++203000
++204000
++205000
++206000
++207000
++208000
++209000
++210000
++211000
++212000
++213000
++214000
++215000
++216000
++217000
++218000
++219000
++220000
++221000
++222000
++223000
++224000
++225000
++226000
++227000
++228000
++229000
++230000
++231000
++232000
++233000
++234000
++235000
++236000
++237000
++238000
++239000
++240000
++241000
++242000
++243000
++244000
++245000
++246000
++247000
++248000
++249000
++250000
++251000
++252000
++253000
++254000
++255000
++256000
++257000
++258000
++259000
++260000
++261000
++262000
++263000
++264000
++265000
++266000
++267000
++268000
++269000
++270000
++271000
++272000
++273000
++274000
++275000
++276000
++277000
++278000
++279000
++280000
++281000
++282000
++283000
++284000
++285000
++286000
++287000
++288000
++289000
++290000
++291000
++292000
++293000
++294000
++295000
++296000
++297000
++298000
++299000
++300000
++301000
++302000
++303000
++304000
++305000
++306000
++307000
++308000
++309000
++310000
++311000
++312000
++313000
++314000
++315000
++316000
++317000
++318000
++319000
++320000
++321000
++322000
++323000
++324000
++325000
++326000
++327000
++328000
++329000
++330000
++331000
++332000
++333000
++334000
++335000
++336000
++337000
++338000
++339000
++340000
++341000
++342000
++343000
++344000
++345000
++346000
++347000
++348000
++349000
++350000
++351000
++352000
++353000
++354000
++355000
++356000
++357000
++358000
++359000
++360000
++361000
++362000
++363000
++364000
++365000
++366000
++367000
++368000
++369000
++370000
++371000
++372000
++373000
++374000
++375000
++376000
++377000
++378000
++379000
++380000
++381000
++382000
++383000
++384000
++385000
++386000
++387000
++388000
++389000
++390000
++391000
++392000
++393000
++394000
++395000
++396000
++397000
++398000
++399000
++400000
++401000
++402000
++403000
++404000
++405000
++406000
++407000
++408000
++409000
++410000
++411000
++412000
++413000
++414000
++415000
++416000
++417000
++418000
++419000
++420000
++421000
++422000
++423000
++424000
开始解析类型2
++1000
++2000
++3000
++4000
++5000
++6000
++7000
++8000
++9000
++10000
++11000
++12000
++13000
++14000
++15000
++16000
++17000
++18000
++19000
++20000
++21000
++22000
++23000
++24000
++25000
++26000
++27000
++28000
++29000
++30000
++31000
++32000
++33000
++34000
++35000
++36000
++37000
++38000
++39000
++40000
++41000
++42000
++43000
++44000
++45000
++46000
++47000
++48000
++49000
++50000
++51000
++52000
++53000
++54000
++55000
++56000
++57000
++58000
++59000
++60000
++61000
++62000
++63000
++64000
++65000
++66000
++67000
++68000
++69000
开始解析类型3
-- set @today=curdate();
-- set @yesterday=date_sub(curdate(),INTERVAL 1 DAY);
-- set @tomorrow=date_sub(curdate(),INTERVAL -1 DAY);
-- set '2016-01-01'=@yesterday;
-- set '2016-08-22'=@tomorrow;

-- 无锡
select
an_hao,
an_jian_ming_cheng,
shi_jian kai_ting_ri_qi,
fa_ting shen_li_fa_ting,
shen_pan_zhang
from wxfy
where add_time>='2016-01-01' and add_time<='2016-08-22'
union all
-- 江苏泰州
select
an_hao,
an_jian_ming_chen an_jian_ming_cheng,
ri_qi kai_ting_ri_qi,
fa_ting shen_li_fa_ting,
zhu_shen shen_pan_zhang
from js_taizhou
where updatetime>='2016-01-01' and updatetime<='2016-08-22'
union all
-- 江苏常州
select
an_hao,
an_you an_jian_ming_cheng,
kai_ting_shi_jian kai_ting_ri_qi,
fa_ting shen_li_fa_ting,
zhu_shen_fa_guan shen_pan_zhang
from czfy
where add_time>='2016-01-01' and add_time<='2016-08-22'
union all
-- 南通法院
select
'' an_hao,
an_jian_ming_cheng,
kai_ting_shi_jian kai_ting_ri_qi,
fa_ting shen_li_fa_ting,
shen_pan_zhang
from ntfy
where add_time>='2016-01-01' and add_time<'2016-08-22'
union all
-- 连云港法院
select
an_hao,
an_jian_ming_cheng,
kai_ting_shi_jian kai_ting_ri_qi,
kai_ting_di_dian shen_li_fa_ting,
'' shen_pan_zhang
from lygfy
where add_time>='2016-01-01' and add_time<'2016-08-22'
union all
-- 厦门法院
select
an_hao,
an_jian_shuo_ming an_jian_ming_cheng,
kai_ting_shi_jian kai_ting_ri_qi,
kai_ting_di_dian shen_li_fa_ting,
fa_guan shen_pan_zhang
from xiamenfy
where add_time>='2016-01-01' and add_time<'2016-08-22'





++1000
++2000
++3000
++4000
++5000
++6000
开始解析类型4
-- set @today=curdate();
-- set @yesterday=date_sub(curdate(), INTERVAL 1 DAY);
-- set @tomorrow=date_sub(curdate(), INTERVAL -1 DAY);
-- set '2016-01-01'=@yesterday;
-- set '2016-08-22'=@today;


-- 山东高院
select
neirong content
from sd_gaoyuan
where updatetime >='2016-01-01' and updatetime<'2016-08-22'
union all
-- 福建法院
select 
gg_detail content
from fjcourt
where add_time >='2016-01-01' and add_time<'2016-08-22'
开始解析类型5
-- set @today=curdate();
-- set @yesterday=date_sub(curdate(), INTERVAL 1 DAY);
-- set @tomorrow=date_sub(curdate(), INTERVAL -1 DAY);
-- set '2016-01-01'=@yesterday;
-- set '2016-08-22'=@today;

-- 徐州法院
select
gg_detail content
from xzfy
where add_time >='2016-01-01' and add_time<'2016-08-22'
++1000
++2000
++3000
++4000
++5000
++6000
++7000
++8000
++9000
++10000
++11000
++12000
++13000
++14000
[hive, -e, "LOAD DATA LOCAL INPATH '/home/tianjingwang/datafile/2016-08-21' overwrite into TABLE ods.kai_ting_gong_gao partition(dt='2016-08-21')"]
--------------------------------stdout----------------------------------
Moved: 'hdfs://hadoop1:8020/user/hive/warehouse/ods.db/kai_ting_gong_gao/dt=2016-08-21/notice_type1.txt' to trash at: hdfs://hadoop1:8020/user/root/.Trash/Current
Moved: 'hdfs://hadoop1:8020/user/hive/warehouse/ods.db/kai_ting_gong_gao/dt=2016-08-21/notice_type2.txt' to trash at: hdfs://hadoop1:8020/user/root/.Trash/Current
Moved: 'hdfs://hadoop1:8020/user/hive/warehouse/ods.db/kai_ting_gong_gao/dt=2016-08-21/notice_type3.txt' to trash at: hdfs://hadoop1:8020/user/root/.Trash/Current
Moved: 'hdfs://hadoop1:8020/user/hive/warehouse/ods.db/kai_ting_gong_gao/dt=2016-08-21/notice_type4.txt' to trash at: hdfs://hadoop1:8020/user/root/.Trash/Current
Moved: 'hdfs://hadoop1:8020/user/hive/warehouse/ods.db/kai_ting_gong_gao/dt=2016-08-21/notice_type5.txt' to trash at: hdfs://hadoop1:8020/user/root/.Trash/Current

========================================================================
--------------------------------error-----------------------------------

Logging initialized using configuration in jar:file:/opt/cloudera/parcels/CDH-5.6.0-1.cdh5.6.0.p0.45/jars/hive-common-1.1.0-cdh5.6.0.jar!/hive-log4j.properties
Loading data to table ods.kai_ting_gong_gao partition (dt=2016-08-21)
Partition ods.kai_ting_gong_gao{dt=2016-08-21} stats: [numFiles=5, numRows=0, totalSize=144105606, rawDataSize=0]
OK
Time taken: 3.722 seconds

========================================================================
[sh, home/likai/ImportCourtNoticeToHbase, 2016-08-21]
--------------------------------stdout----------------------------------

========================================================================
--------------------------------error-----------------------------------
sh: home/likai/ImportCourtNoticeToHbase: 没有那个文件或目录

========================================================================
